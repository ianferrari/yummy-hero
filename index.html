<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å¥å¥çš„é¤æ¡Œå°éšŠé•·</title>
    <style>
        /* --- å…¨å±€è¨­å®š --- */
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background-color: #FFF8E1;
            margin: 0;
            height: 100vh;
            overflow: hidden;
            user-select: none;
            -webkit-user-select: none;
        }

        /* --- é€šç”¨é¡åˆ¥ --- */
        .hidden { display: none !important; }
        .screen {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center; /* æ”¹ç‚ºç½®ä¸­ */
        }

        /* --- 1. è§’è‰²é¸æ“‡é é¢æ¨£å¼ --- */
        #selection-screen h2 {
            color: #E65100;
            font-size: 1.5rem;
            margin-bottom: 20px;
        }

        .grid-container {
            display: grid;
            grid-template-columns: repeat(2, 1fr); /* å…©åˆ— */
            gap: 15px;
            padding: 10px;
            max-height: 80vh;
            overflow-y: auto; /* è§’è‰²å¤šæ™‚å¯æ»‘å‹• */
        }

        .char-card {
            background: white;
            border: 3px solid #FFD54F;
            border-radius: 15px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: transform 0.1s;
            box-shadow: 0 4px 0 #FFB300;
        }

        .char-card:active {
            transform: scale(0.95);
            box-shadow: 0 0 0 #FFB300;
        }

        .char-icon { font-size: 3rem; display: block; }
        .char-name { font-size: 1rem; color: #5D4037; font-weight: bold; margin-top: 5px; display: block; }


        /* --- 2. éŠæˆ²é é¢æ¨£å¼ (æ²¿ç”¨ä¸Šæ¬¡å¾®èª¿) --- */
        #game-screen {
            justify-content: space-evenly; /* éŠæˆ²é é¢ç¶­æŒåŸæœ¬åˆ†ä½ˆ */
        }

        .top-bar {
            position: absolute;
            top: 10px;
            left: 10px;
        }

        .back-btn {
            background: #BCAAA4;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
        }

        .main-character {
            font-size: 8rem;
            transition: transform 0.2s;
        }
        
        .eating { transform: scale(1.2) rotate(10deg); } /* åƒæ±è¥¿åŠ ä¸€é»æ—‹è½‰ */

        .message-box {
            height: 30px;
            color: #5D4037;
            font-weight: bold;
            font-size: 1.4rem;
        }

        .progress-container {
            width: 80%;
            height: 25px;
            background-color: #FFE082;
            border-radius: 15px;
            overflow: hidden;
            border: 3px solid #FFCA28;
        }

        .progress-bar {
            height: 100%;
            width: 100%;
            background-color: #66BB6A;
            transition: width 0.5s, background-color 0.5s;
        }

        .count-display { font-size: 1.5rem; color: #8D6E63; font-weight: bold; }

        .feed-btn {
            background-color: #FF6F00;
            color: white;
            border: none;
            border-radius: 50px;
            padding: 20px 50px;
            font-size: 1.6rem;
            font-weight: bold;
            box-shadow: 0 6px 0 #E65100;
            touch-action: manipulation; /* å„ªåŒ–è§¸æ§ */
        }

        .feed-btn:active {
            box-shadow: 0 0 0 #E65100;
            transform: translateY(6px);
        }

        .feed-btn:disabled {
            background-color: #90A4AE;
            box-shadow: none;
            cursor: default;
            transform: none;
        }
    </style>
</head>
<body>

    <div id="selection-screen" class="screen">
        <h2>å¥å¥ä»Šå¤©æƒ³è·Ÿèª°åƒé£¯ï¼Ÿ</h2>
        <div class="grid-container" id="grid">
            </div>
    </div>

    <div id="game-screen" class="screen hidden">
        <div class="top-bar">
            <button class="back-btn" onclick="resetGame()">â¬… é‡é¸</button>
        </div>

        <div class="message-box" id="message">è‚šå­å¥½é¤“å–”...</div>
        
        <div class="main-character" id="character-display">ğŸ¼</div>

        <div class="progress-container">
            <div class="progress-bar" id="progressBar"></div>
        </div>
        <div class="count-display">å‰© <span id="count">20</span> å£</div>

        <button class="feed-btn" id="feedBtn" onclick="feedAction()">é¤µä»–åƒä¸€å£ ğŸ¥„</button>
    </div>

    <script>
        // --- è³‡æ–™è¨­å®šå€ (çˆ¸çˆ¸å¯ä»¥åœ¨é€™è£¡æ–°å¢/ä¿®æ”¹è§’è‰²) ---
        const characters = [
            { id: 'police', name: 'è­¦å¯Ÿå”å”', icon: 'ğŸ‘®â€â™‚ï¸' },
            { id: 'worker', name: 'å·¥äººå”å”', icon: 'ğŸ‘·â€â™‚ï¸' },
            { id: 'cleaner', name: 'æ¸…æ½”éšŠå”å”', icon: 'ğŸš›' }, // ç”¨åƒåœ¾è»Šä»£è¡¨
            { id: 'trex', name: 'æš´é¾', icon: 'ğŸ¦–' },
            { id: 'brachio', name: 'è…•é¾', icon: 'ğŸ¦•' },
            { id: 'tri', name: 'ä¸‰è§’é¾', icon: 'ğŸ¦' }, // ç”¨çŠ€ç‰›æš«ä»£ (å¤–å‹æœ€åƒ)
            { id: 'stego', name: 'åŠé¾', icon: 'ğŸŠ' }, // ç”¨é±·é­šæš«ä»£ (èƒŒä¸Šæœ‰åˆº)
            { id: 'panda', name: 'ç†Šè²“', icon: 'ğŸ¼' }
        ];

        let totalBites = 20; // é è¨­å£æ•¸
        let currentBites = totalBites;
        let selectedChar = null;

        // --- DOM å…ƒç´  ---
        const selectionScreen = document.getElementById('selection-screen');
        const gameScreen = document.getElementById('game-screen');
        const grid = document.getElementById('grid');
        const charDisplay = document.getElementById('character-display');
        const message = document.getElementById('message');
        const countSpan = document.getElementById('count');
        const progressBar = document.getElementById('progressBar');
        const btn = document.getElementById('feedBtn');

        // --- åˆå§‹åŒ–ï¼šç”¢ç”Ÿé¸æ“‡é¸å–® ---
        function init() {
            grid.innerHTML = '';
            characters.forEach(char => {
                let card = document.createElement('div');
                card.className = 'char-card';
                card.innerHTML = `<span class="char-icon">${char.icon}</span><span class="char-name">${char.name}</span>`;
                card.onclick = () => startGame(char);
                grid.appendChild(card);
            });
        }

        // --- é–‹å§‹éŠæˆ² ---
        function startGame(char) {
            selectedChar = char;
            currentBites = totalBites;
            
            // UI åˆ‡æ›
            selectionScreen.classList.add('hidden');
            gameScreen.classList.remove('hidden');
            
            // é‡ç½®éŠæˆ²ç‹€æ…‹
            charDisplay.innerText = char.icon;
            message.innerText = `${char.name}è‚šå­é¤“äº†...`;
            countSpan.innerText = currentBites;
            progressBar.style.width = '100%';
            progressBar.style.backgroundColor = '#66BB6A';
            btn.disabled = false;
            btn.innerText = `é¤µ${char.name}åƒä¸€å£ ğŸ¥„`;
            btn.style.backgroundColor = '#FF6F00';
            document.body.style.backgroundColor = '#FFF8E1';
        }

        // --- é¤µé£Ÿå‹•ä½œ ---
        function feedAction() {
            if (currentBites <= 0) return;

            currentBites--;
            countSpan.innerText = currentBites;
            
            // æ›´æ–°é€²åº¦æ¢
            let percentage = (currentBites / totalBites) * 100;
            progressBar.style.width = percentage + "%";
            if (percentage < 30) progressBar.style.backgroundColor = "#EF5350";

            // å‹•ç•«èˆ‡éŸ³æ•ˆ
            charDisplay.classList.add('eating');
            message.innerText = "é˜¿å§†ï¼çœŸå¥½åƒï¼";
            
            // 0.4ç§’å¾Œå¾©åŸ
            setTimeout(() => {
                charDisplay.classList.remove('eating');
                if (currentBites > 0) {
                    message.innerText = "é‚„è¦å†ä¸€å£...";
                } else {
                    finishGame();
                }
            }, 400);
        }

        // --- çµæŸéŠæˆ² ---
        function finishGame() {
            message.innerText = `${selectedChar.name}åƒé£½äº†ï¼å¥å¥å¥½æ£’ï¼`;
            btn.innerText = "ä»»å‹™å®Œæˆ ğŸ‰";
            btn.disabled = true;
            btn.style.backgroundColor = "#66BB6A"; // æŒ‰éˆ•è®Šç¶ 
            document.body.style.backgroundColor = "#E8F5E9"; // èƒŒæ™¯è®Šç¶ 
            charDisplay.innerText = "â¤ï¸"; // è®Šæˆæ„›å¿ƒ
            
            // å™´å½©å¸¶
            let i = 0;
            let interval = setInterval(() => {
                if(i > 10) clearInterval(interval);
                createConfetti();
                i++;
            }, 200);
        }

        // --- é‡é¸è§’è‰² ---
        function resetGame() {
            gameScreen.classList.add('hidden');
            selectionScreen.classList.remove('hidden');
            document.body.style.backgroundColor = '#FFF8E1'; // èƒŒæ™¯å¾©åŸ
        }

        // --- å½©å¸¶ç‰¹æ•ˆ ---
        function createConfetti() {
            const confetti = document.createElement('div');
            confetti.innerText = ['ğŸ‰', 'âœ¨', 'â­', 'ğŸˆ'][Math.floor(Math.random() * 4)];
            confetti.style.position = 'absolute';
            confetti.style.left = Math.random() * 90 + 5 + 'vw';
            confetti.style.top = '-10vh';
            confetti.style.fontSize = '2rem';
            confetti.style.transition = 'top 2s ease-in';
            confetti.style.zIndex = '100';
            document.body.appendChild(confetti);

            setTimeout(() => {
                confetti.style.top = '110vh';
            }, 100);
            
            // æ¸…é™¤ DOM ä»¥å…å †ç©
            setTimeout(() => {
                confetti.remove();
            }, 2500);
        }

        // å•Ÿå‹•ç¨‹å¼
        init();

    </script>
</body>
</html>
